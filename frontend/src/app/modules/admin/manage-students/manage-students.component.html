<app-header></app-header>
<div class="manage-container">
  <div class="page-header">
    <h1 class="page-title">Manage Students</h1>
    <p class="page-subtitle">View and manage student records</p>
  </div>

  <!-- Filters Card -->
  <div class="filter-card">
    <div class="filter-header">
      <h3 class="filter-title">Filters</h3>
      <span class="filter-badge" *ngIf="hasActiveFilters()">Active</span>
    </div>
    
    <div class="filter-grid">
      <div class="form-group">
        <label class="form-label">Department</label>
        <select class="form-select" [(ngModel)]="filters.department">
          <option value="">All Departments</option>
          <option value="Computer Science">Computer Science</option>
          <option value="Electronics">Electronics</option>
          <option value="Mechanical">Mechanical</option>
          <option value="Civil">Civil</option>
        </select>
      </div>

      <div class="form-group">
        <label class="form-label">Year</label>
        <select class="form-select" [(ngModel)]="filters.year">
          <option value="">All Years</option>
          <option value="1">1st Year</option>
          <option value="2">2nd Year</option>
          <option value="3">3rd Year</option>
          <option value="4">4th Year</option>
        </select>
      </div>

      <div class="form-group">
        <label class="form-label">Semester</label>
        <select class="form-select" [(ngModel)]="filters.semester">
          <option value="">All Semesters</option>
          <option value="1">Semester 1</option>
          <option value="2">Semester 2</option>
        </select>
      </div>

      <div class="form-actions">
        <button class="btn btn-primary" (click)="applyFilters()">
          <span class="btn-icon">âœ“</span>
          <span>Apply</span>
        </button>
        <button class="btn btn-secondary" (click)="clearFilters()">
          <span class="btn-icon">âœ•</span>
          <span>Clear</span>
        </button>
      </div>
    </div>
  </div>

  <!-- Loading State -->
  <div *ngIf="loading" class="loading-state">
    <div class="loading-spinner"></div>
    <p class="loading-text">Loading students...</p>
  </div>

  <!-- Error State -->
  <div *ngIf="error" class="error-state">
    <div class="error-icon">âš ï¸</div>
    <p class="error-message">{{ error }}</p>
  </div>

  <!-- Students Table -->
  <div *ngIf="!loading && !error" class="content-card">
    <div class="card-header">
      <h3 class="card-title">Students List</h3>
      <span class="card-badge">{{ students.length }}</span>
    </div>

    <!-- Empty State -->
    <div *ngIf="students.length === 0" class="empty-state">
      <div class="empty-icon">ğŸ‘¥</div>
      <h4 class="empty-title">No students found</h4>
      <p class="empty-text">Try adjusting your filters to see results</p>
    </div>

    <!-- Table -->
    <div *ngIf="students.length > 0" class="table-container">
      <table class="data-table">
        <thead>
          <tr>
            <th>Roll Number</th>
            <th>Name</th>
            <th>Email</th>
            <th>Department</th>
            <th>Year</th>
            <th>Semester</th>
            <th>Status</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let student of students">
            <td class="td-mono">{{ student.roll_number }}</td>
            <td class="td-bold">{{ student.first_name }} {{ student.last_name }}</td>
            <td class="td-secondary">{{ student.email }}</td>
            <td>{{ student.department }}</td>
            <td class="td-center">{{ student.year }}</td>
            <td class="td-center">{{ student.semester }}</td>
            <td>
              <span class="status-badge" [ngClass]="{
                'status-active': student.academic_status === 'active',
                'status-detained': student.academic_status === 'detained',
                'status-promoted': student.academic_status === 'promoted'
              }">
                {{ student.academic_status || 'N/A' }}
              </span>
            </td>
            <td>
              <div class="action-buttons">
                <button class="btn-action btn-action-success" (click)="updateStatus(student.id, 'active')" title="Activate">
                  <span>âœ“</span>
                </button>
                <button class="btn-action btn-action-warning" (click)="updateStatus(student.id, 'detained')" title="Detain">
                  <span>âš </span>
                </button>
                <button class="btn-action btn-action-info" (click)="reevaluateEligibility(student.id)" title="Re-evaluate">
                  <span>â†»</span>
                </button>
              </div>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
  </div>
</div>
